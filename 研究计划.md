## 研究计划
Remix China 要做的事不仅仅只是在国内搞个 China 分支。我们还要研究 Remix 目前遇到的技术瓶颈，并且尝试去解决它们。我们还会跟国内的链进行合作，帮助他们去完善 IDE 方面的生态。

现在已经有了几个比较明确的研究方向，列举如下。后面如果还有的话会再补充。

#### 在 Remix IDE 上集成 WebContainer
Remix IDE 和 Chain IDE 相比有一个缺陷，就是无法提供 Nodejs 环境，因而无法使用 hardhat、truffle、ganache 这些常用的开发工具。

Chain IDE 的解决方案是在服务器上起一个 linux 环境（我猜可能是用 docker 起的吧），然后前端通过 websocket 和 linux 通信。

WebContainer 是 Stackblitz 开源的一项技术，它可以在浏览器内部运行 Nodejs 。和 Chain IDE 那套中心化的方案相比，WebContainer 的计算压力完全在用户自己电脑上，而且不受网络环境的影响。

如果 Remix IDE 能结合这项技术，那就可以弥补 Nodejs 环境的缺失，整个使⽤体验能再上升⼀个 level 。这样 Remix IDE 和 Chain IDE 比就没有弱点了，可以全面碾压 Chain IDE 。

#### 用 VSCode 插件来实现 Remix IDE 上的功能
前面说 Remix IDE 没有弱点，那只是和 Chain IDE 相比，如果和 VSCode 比还是有弱点的。最典型一个弱点就是对 terminal 的集成。虽然 Remix IDE 有一个 terminal 模块，但那是个假 terminal ，只能执行一些简单的 js 脚本。有点像浏览器开发者工具里的 console ，而且还是个阉割版。

虽然 Remix IDE 有桌面版，但那也是个鸡肋。我之前一直以为桌面版会提供一个真实的 terminal ，但实际体验了以后才发现，还是和 Online IDE 的那个 terminal 一样。所谓的桌面版只是用 electron 套了个壳，连静态文件都没打进安装包里，首次加载的时候会从 github 上下载静态文件的压缩包。国内经常看到有用户在各大社区论坛抱怨 Remix IDE 桌面版打开的时候卡在 loading 页，这就是因为 github 经常会被 GFW 封锁，导致静态文件下载失败。在国内用桌面版还不如直接用 Online IDE ，毕竟那个是有 cloudflare 做了 CDN 加速的。cloudflare 被封的概率比 github 小多了。而且 Online IDE 上还能用浏览器钱包。在桌面版上反而用不了。

Remix IDE 桌面版和 Online 版相比唯一的优势就是访问本地文件不需要用户手动起 remixd 服务了。但如果你以为它是像 VSCode 那样访问本地文件，那你就错了。它其实还是通过 remixd 来访问的，只不过桌面版自动帮你启动了 remixd 。而且 remixd 是不支持多开的。这意味着你无法无法像 VSCode 那样开多个窗口，每个窗口访问不同的目录。

我觉得 Remix 团队没必要在这个桌面版上浪费时间。他们应该多花一点时间在 VSCode 插件上。他们现在的插件做的实在是不怎么样。反倒是社区有一个叫 remix-light 的插件，用户体验比官方的还好。但是这个插件的功能太简陋了，只做了编译、部署、调用，而且只支持模拟链。如果能把 Remix IDE 上有但是 VSCode 上没有的功能都能用 VSCode 插件来实现，那 VSCode 就可以变成一个完美的智能合约 IDE 。而且 VSCode 也有 Online 版的。不过现有的两个 Remix 插件（官方和社区）在 VSCode Online 版上无法使用。具体原因不太清楚，应该是有什么技术问题需要解决。但只要解决了这个问题，那 Online 版也可以完美覆盖。这才是我心目中最完美的智能合约 IDE 。

我后面会跟 Remix 官方团队提下这个建议，并且我们自己也会投入研发精力去做这个事情。remix-light 的作者我应该也会邀请一下。

#### 用 TypeScript 写合约
最近在帮星火链网做 Remix 插件开发。其中有一个需求很不好做。

星火链网是支持用 Solidity 和 JavaScript 写合约的。Solidity 合约经过编译可以获取到 abi 信息，我可以根据 abi 构建出合约的 UI 。这样用户调用合约的时候就很方便，要调哪个方法，输入什么参数，一目了然。

但 JS 合约就做不到这样了。因为少了编译这一步，无法提取到类似 abi 的信息。

星火链网官方提供了一个检测工具，可以从 JS 合约中提取出一点信息。但这个信息非常有限。我只能大概判断出有合约里有哪些方法可以调用，但具体怎么调还是无法判断。

我举个例子，假如有一个 add 方法，逻辑就是把两个参数加一下。那我的调这个方法的参数就是这样
```json
{
  "method": "add",
  "params": { "a": 1, "b": 2 }
}
```
星火链网的 JS 合约不像 Solidity 那样可以直接去调你想调的那个方法，而是要先调入口方法，在入口方法中根据你输入的参数来判断出你想调哪个方法，然后才去调那个方法。这个判断逻辑完全是用户自己定义的。

上面这个例子中 method 代表方法名，params 代表参数。但用户不一定要按这个方式来定义，他完全可以换个 key ，比如 functionName 表示方法名，parameter 表示参数。只要他写的代码和他自己定义的 key 匹配就可以了。但这样我就无法事先知道 key 值，也就无法帮用户去构建入参。这意味着用户只能自己传 json 对象了。试想一下，每次用户调合约都传一个 json ，这得多痛苦。

我有一个比较大胆的想法，就是用 TS 来写合约。编译成 JS 后再部署合约。我们可以通过 lint 工具强制用户一定要把类型定义完整。这样我们就能在编译的时候从合约中提取到很多有价值的信息，其中就包括参数类型，返回值等等。但具体要怎么做我还不知道。还得做技术调研。但我感觉这条路应该走得通，而且用户体验应该可以做的和 Solidity 一样好。只不过花的时间可能会比较长。


#### 模拟链改造
